# Vibe - プロダクト要件定義（PRD）

## プロダクト概要
- 非エンジニアの経営者・事業者が、GitHub アカウントやリポジトリを用意せずに、自然言語の対話だけでフルスタック Web アプリ（Next.js + DB + 認証 + EC + 管理画面）を自動生成できるインフラ。
- UI は「左チャット + 右プレビュー（Claude Artifact風）」の 2-pane 構成。左ペインで要件入力・進行状況を確認し、右ペインで自動生成された preview デプロイを即時確認できる。
- 生成プロセスの設計思想、ルール、フロー、本番デプロイロジックはカスタムプロンプトに集約され、これが Vibe の標準仕様書かつ知財の中心となる。

## ゴール / 非ゴール
- ゴール（MVP）
  - 代表ユースケースとして「単一店舗向けミニマル EC（商品登録/在庫/決済/管理画面）」を、非エンジニアが会話ベースで生成し、preview を右ペインで確認できる。
  - カスタムプロンプトが対話フロー・生成・検証・デプロイを制御し、ユーザは専門用語を理解せずに完了できる。
- 非ゴール
  - マルチプロジェクト同時生成やマルチリージョン冗長化。
  - 完全な多言語 UI・高度なデザインエディタ。
  - ユーザが GitHub にログインして設定を編集するようなエンジニアリング体験。

## ペルソナ
- 技術リテラシーが低い経営者/事業者。専門用語を避け、ビジネス成果を 3 点程度の箇条書きで確認すれば進行できる。GitHub もローカル開発も不要。

## UI / UX 要件
- 2-pane 構成：
  - 左ペイン：チャット形式でヒアリング・進行状況の提示。選択肢中心で、専門用語は使わない。
  - 右ペイン：自動生成された preview デプロイを常時表示。再生成時は自動リロード。
- 確認フロー：
  - 「こういうアプリを作ろうと思います。よろしいですか？」とビジネス成果（例：売上チャネル開設、決済導入、在庫管理の自動化）を 3 項目で提示し、ユーザの「OK」で進行。
  - エンジニアリング的な仕様確認は行わず、バックエンドの詳細はカスタムプロンプトが自律的に決定。

## プロセス（AI が行う作業フロー）
1. **ヒアリング/要件抽出（カスタムプロンプト主導）**
   - ユーザ入力をもとに追加質問を自動生成。選択肢+自由入力を組み合わせ、ビジネスアウトカムを確認。
   - 決済手段（Stripe 固定）、DB 種別（Supabase/Postgres）、本番設定、preview 時の mock 方針などをプロンプト内で確定。
2. **設計・スキャフォールド生成**
   - Next.js (App Router/TS) プロジェクトを生成。API/Server Actions、Tailwind ベースの UI、管理画面を構成。
   - DB スキーマと Prisma マイグレーションを生成し、認証・決済・画像アップロードなどの周辺機能を組み込む。
3. **ローカル自動検証（preview 前の必須ステップ）**
   - chrome-devtools-mcp により dev server を起動し、lint/test/主要フローのクリック検証を機械的に実行。
   - エラーがあれば preview デプロイを停止し、AI が自律的にコードを再修正してフローを繰り返す。
4. **preview デプロイ生成**
   - 検証済みのビルドを自動で preview 環境にデプロイし、右ペインにプレビューを表示。バージョンを保持しロールバック可能にする。
5. **本番デプロイ準備**
   - 本番用 GitHub Actions Workflow をカスタムプロンプトから自動生成（ユーザは GitHub 操作不要）。環境変数や決済キーの入力 UI を左ペインで提供。
6. **引き渡し/課金**
   - プレビューに満足したら「コード買い切り」または「SaaS 利用料」で課金。コード所有権とデプロイ手段を明示して提供。

## 機能要件
- **カスタムプロンプト管理**：標準仕様書としてプロンプトをバージョン管理し、生成・検証・デプロイのフローを定義できること。
- **対話型ヒアリング**：ビジネス成果ベースの追加質問生成。専門用語を排除し、選択肢主体で進行。
- **自動スキャフォールド生成**：Next.js プロジェクト一式（API/Server Actions、DB 接続、認証、Stripe 決済、管理画面、画像アップロード）。
- **DB/マイグレーション生成**：Supabase/Postgres 前提で Prisma スキーマとマイグレーションを生成。
- **検証オーケストレーション**：chrome-devtools-mcp を用いた lint/test/E2E クリック検証を自動実行し、失敗時は AI が再修正。
- **preview デプロイ表示**：検証済みビルドを自動デプロイし、右ペインでライブプレビューを提供。履歴管理とロールバック対応。
- **本番 Workflow 生成**：GitHub Actions を自動生成し、ユーザは GitHub アカウント不要で本番デプロイ準備が整う。
- **所有権/配布**：プレビュー後にコード買い切りダウンロードまたは SaaS 利用を選択できる。秘密情報を除外したバンドルを提供。

## 非機能要件
- パフォーマンス：生成→検証→preview デプロイまで 20 分以内（MVP 目標）。
- セキュリティ：認証・決済キーは安全に保管し、生成コードには OWASP Top 10 対策テンプレートを適用。自動検証で lint/test を必須化。
- 可用性：生成/検証/デプロイのジョブをリトライ可能にし、プレビュー履歴を保持。
- UX：専門用語を避け、全操作を 2-pane で完結。説明はビジネス成果ベースで短く提示。

## MVP スコープ（ユースケース）
- **単一店舗向けミニマル EC** をフルで通す。
  - 商品登録・一覧・詳細・カート・決済（Stripe）・在庫管理・注文履歴。
  - 管理画面で商品/在庫/注文の更新が可能。
  - 認証は Email/OTP 前提。DB は Supabase/Postgres 固定。

## KPI
- 生成→preview までの平均時間（目標 20 分以内）。
- preview を確認して「OK」したユーザ比率（満足度指標）。
- コード買い切りまたは SaaS への転換率。

## オープンな課題
- 決済手段の拡張（PayPal, Apple Pay）と PCI DSS 対応の責任分解点。
- DB 選択肢の拡大（PlanetScale/MySQL 等）と抽象化方針。
- 自動検証カバレッジの拡張（パフォーマンス、アクセシビリティ）。
